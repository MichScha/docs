<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation (Wiki) for EMS-ESP"><link href=https://emsesp.github.io/docs/Configuring/ rel=canonical><link href=../Getting-Started/ rel=prev><link href=../WebUI/ rel=next><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.4"><title>Configuring - EMS-ESP</title><link rel=stylesheet href=../assets/stylesheets/main.9c788c91.min.css><link rel=stylesheet href=../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><link rel=stylesheet href=../assets/css/github.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-SVDSJ3QTVC"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-SVDSJ3QTVC",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-SVDSJ3QTVC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#what-the-onboard-led-is-showing-you class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=EMS-ESP class="md-header__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EMS-ESP </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Configuring </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-hidden=true type=radio name=__palette id=__palette_1> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> Home </a> </li> <li class=md-tabs__item> <a href=../All-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class=md-tabs__link> Integrations </a> </li> <li class=md-tabs__item> <a href=../Support/ class=md-tabs__link> Help </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=EMS-ESP class="md-nav__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> EMS-ESP </label> <div class=md-nav__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 tabindex=0 aria-expanded=true> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> News </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> About EMS-ESP </a> </li> <li class=md-nav__item> <a href=../Version-Release-History/ class=md-nav__link> Version Release History </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> Getting Started </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Configuring <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Configuring </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-the-onboard-led-is-showing-you class=md-nav__link> What the onboard LED is showing you </a> </li> <li class=md-nav__item> <a href=#first-time-configuration class=md-nav__link> First-time Configuration </a> </li> <li class=md-nav__item> <a href=#ems-esp-settings class=md-nav__link> EMS-ESP Settings </a> <nav class=md-nav aria-label="EMS-ESP Settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#board-profile class=md-nav__link> Board Profile </a> </li> <li class=md-nav__item> <a href=#ems-bus class=md-nav__link> EMS Bus </a> </li> <li class=md-nav__item> <a href=#general-options class=md-nav__link> General Options </a> </li> <li class=md-nav__item> <a href=#formatting-options class=md-nav__link> Formatting Options </a> </li> <li class=md-nav__item> <a href=#temperature-sensors class=md-nav__link> Temperature Sensors </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> Logging </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt-settings class=md-nav__link> MQTT Settings </a> </li> <li class=md-nav__item> <a href=#adding-external-sensors class=md-nav__link> Adding external sensors </a> </li> <li class=md-nav__item> <a href=#customization class=md-nav__link> Customization </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> WebUI </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> MQTT </a> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../Console/ class=md-nav__link> Console </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_1_10 type=checkbox id=__nav_1_10> <label class=md-nav__link for=__nav_1_10 tabindex=0 aria-expanded=false> For Developers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="For Developers" data-md-level=2> <label class=md-nav__title for=__nav_1_10> <span class="md-nav__icon md-icon"></span> For Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Coding/ class=md-nav__link> Coding </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=../EMS-bus/ class=md-nav__link> The EMS protocol </a> </li> <li class=md-nav__item> <a href=../EMS-Circuit/ class=md-nav__link> Example EMS Circuit </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 tabindex=0 aria-expanded=false> Supported Devices <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Supported Devices" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../All-Devices/ class=md-nav__link> All Devices and Entities </a> </li> <li class=md-nav__item> <a href=../Boilers/ class=md-nav__link> Boilers </a> </li> <li class=md-nav__item> <a href=../Thermostats/ class=md-nav__link> Thermostats </a> </li> <li class=md-nav__item> <a href=../Solar-Modules/ class=md-nav__link> Solar Modules </a> </li> <li class=md-nav__item> <a href=../Mixer-Modules/ class=md-nav__link> Mixer Modules </a> </li> <li class=md-nav__item> <a href=../Heat-Pumps/ class=md-nav__link> Heat Pumps </a> </li> <li class=md-nav__item> <a href=../Controllers/ class=md-nav__link> Controllers </a> </li> <li class=md-nav__item> <a href=../Switches/ class=md-nav__link> Switches </a> </li> <li class=md-nav__item> <a href=../Other-Devices/ class=md-nav__link> Other Devices </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 tabindex=0 aria-expanded=false> Integrations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Integrations data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> Home Assistant </a> </li> <li class=md-nav__item> <a href=../IOBroker/ class=md-nav__link> IOBroker </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> Domoticz </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> openHAB </a> </li> <li class=md-nav__item> <a href=../Loxone/ class=md-nav__link> Loxone </a> </li> <li class=md-nav__item> <a href=../Grafana/ class=md-nav__link> Grafana </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 tabindex=0 aria-expanded=false> Help <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Help data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Support/ class=md-nav__link> Support </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../tips-and-tricks/ class=md-nav__link> Tips & Tricks </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-the-onboard-led-is-showing-you class=md-nav__link> What the onboard LED is showing you </a> </li> <li class=md-nav__item> <a href=#first-time-configuration class=md-nav__link> First-time Configuration </a> </li> <li class=md-nav__item> <a href=#ems-esp-settings class=md-nav__link> EMS-ESP Settings </a> <nav class=md-nav aria-label="EMS-ESP Settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#board-profile class=md-nav__link> Board Profile </a> </li> <li class=md-nav__item> <a href=#ems-bus class=md-nav__link> EMS Bus </a> </li> <li class=md-nav__item> <a href=#general-options class=md-nav__link> General Options </a> </li> <li class=md-nav__item> <a href=#formatting-options class=md-nav__link> Formatting Options </a> </li> <li class=md-nav__item> <a href=#temperature-sensors class=md-nav__link> Temperature Sensors </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> Logging </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt-settings class=md-nav__link> MQTT Settings </a> </li> <li class=md-nav__item> <a href=#adding-external-sensors class=md-nav__link> Adding external sensors </a> </li> <li class=md-nav__item> <a href=#customization class=md-nav__link> Customization </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Configuring</h1> <h2 id=what-the-onboard-led-is-showing-you>What the onboard LED is showing you<a class=headerlink href=#what-the-onboard-led-is-showing-you title="Permanent link">~</a></h2> <div class="admonition info"> <p class=admonition-title>Info</p> <p>During the power-on sequence you'll see a sequence of LED flashes:</p> <ul> <li> <p>1 flash means the EMS bus is not connected</p> </li> <li> <p>2 flashes means the network (wifi or ethernet) is not connected</p> </li> <li> <p>3 flashes means both EMS bus and network are failing. This is a critical error!</p> </li> </ul> <p>During normal operation the LED displays the current status:</p> <ul> <li> <p>A steady solid light indicates a good connection and EMS data is flowing in</p> </li> <li> <p>A slow pulse can mean either the WiFi or the EMS bus are not connected yet</p> </li> <li> <p>A very fast pulse is when the system is booting up and configuring itself which can typically takes a few seconds</p> </li> </ul> </div> <h2 id=first-time-configuration>First-time Configuration<a class=headerlink href=#first-time-configuration title="Permanent link">~</a></h2> <ul> <li>First connect to the Access Point called <code>ems-esp</code> using the default WPA password <code>ems-esp-neo</code>.</li> <li>When you see the captive portal sign-in with username <code>admin</code> and password <code>admin</code>.</li> <li>Set the WiFi credentials and go back to <a href=http://ems-esp>http://ems-esp</a>. Remember to change the password!</li> <li>Now check is if Tx is working and that you have a connection to the EMS bus. If Tx failures are shown in the Web interface try changing the Tx Mode from the settings page. There is no need to re-start the EMS-ESP.</li> <li>Use the WebUI (<a href=http://ems-esp>http://ems-esp</a> or <a href=http://ems-esp.local>http://ems-esp.local</a>) to further configure the settings.</li> </ul> <div class="admonition note"> <p class=admonition-title>If Rx incomplete telegrams are reported in the log, don't panic. Some telegrams can be missed and this is usually caused by noise interference on the line.</p> </div> <h2 id=ems-esp-settings>EMS-ESP Settings<a class=headerlink href=#ems-esp-settings title="Permanent link">~</a></h2> <p>In the <code>Settings</code> page in the WebUI you'll find:</p> <h3 id=board-profile>Board Profile<a class=headerlink href=#board-profile title="Permanent link">~</a></h3> <ul> <li>If you have your own ESP32 development board you can choose from a pre-configured board (If you purchased a BBQKees Gateway this is already preselected) or select <code>Custom</code> to see and change the hardware settings:</li> <li><strong>Rx GPIO</strong> - Which GPIO pin the Rx is assigned to. By default this is GPIO 23 but it can be almost any free pin. Connect this GPIO pin to the RX port on the EMS interface board.</li> <li><strong>Tx GPIO</strong> - Which GPIO pin the Tx is assigned to. By default this is GPIO 5 but it can be almost any free pin. Connect this GPIO pin to the TX port on the EMS interface board.</li> <li><strong>Button GPIO</strong>. Set a pin with pull-up. The button is used for different functions, such as holding for 10 seconds to reset to factory settings.</li> <li><strong>Temperature GPIO</strong>. This is the pin where any external temperature sensors are attached. The Dallas chips DS1822, DS18S20, DS18B20, DS1825 are supported including their parasite varieties and can also be daisy-chained onto a single line, up to 100 sensors.</li> <li><strong>LED GPIO</strong>. This is the pin for the LED, defaulted to the onboard LED on the ESP dev board.</li> <li>And a set of Ethernet settings for the advanced tweakers.</li> </ul> <div class="admonition note"> <p class=admonition-title>On ESP32 development boards there are often also pins marked RX and TX. However, these are usually connected to the USB chip and cannot be used for the EMS interface circuit</p> </div> <h3 id=ems-bus>EMS Bus<a class=headerlink href=#ems-bus title="Permanent link">~</a></h3> <ul> <li><strong>Tx Mode</strong>. Tx Mode is the mode in which EMS-ESP sends telegrams on the EMS bus. Choose the mode that works best for your system and watch for Tx errors in the Web Dashboard and <code>show ems</code> in the Console. Changing the value has immediate effect.</li> <li><code>EMS</code> is the default for EMS1.0 systems but also compatible with most other bus protocols.</li> <li><code>EMS+</code> is designed to work better for EMS2.0/EMS+ systems.</li> <li><code>HT3</code> for Heatronics3 used primarily by Junkers.</li> <li><code>Hardware</code> uses the internal ESP's hardware to send out the telegram. Telegrams are sent immediately. It is the fastest and most efficient method but works only on some systems.</li> <li><strong>Bus ID</strong>. The EMS-ESP can simulate multiple devices. Stick to the <code>Service Key (0x0B)</code> unless using more than one EMS gateways/interface board.</li> </ul> <h3 id=general-options>General Options<a class=headerlink href=#general-options title="Permanent link">~</a></h3> <ul> <li><strong>Hide LED</strong>. Turns off the LED when in normal operating mode. The LED is still shown when booting or when there are connection issues.</li> <li><strong>Enable Telnet Console</strong>. This is on by default and allows users to connect to the in-secure Telnet server on port 23.</li> <li><strong>Enable Analog Sensors</strong>. This enables any GPIO to collect signals, whether it's a digital I/O, a pulse counter or ADC measuring mv.</li> <li><strong>Convert temperature values to Fahrenheit</strong>. For our US friends.</li> <li><strong>Bypass Access Token authorization on API calls</strong>. For RESTful write commands via HTTP POST the access token is required. This is for security reasons to prevent anyone changing device settings. Setting this flag makes the API open. Not recommended!</li> <li><strong>Enable Read only mode</strong>. This disables any outgoing Tx write commands to the EMS bus, essentially putting EMS-ESP into listening mode.</li> <li><strong>Underclock CPU speed</strong>. Under-clocks the ESP to 160Mhz, saving on power, heat and prolonging the lifespan of the chip at the cost of performance and response time. A reboot of EMS-ESP is required.</li> <li><strong>Enable Shower Timer</strong>. Enable to time how long the hot water runs for and it will send out an MQTT message with the duration. The timer starts after a minimal of 2 minutes running time.</li> <li><strong>Enable Shower Alert</strong>. This is experimental and may not work on all systems. After 7 minutes running hot water, send out a warning by 3 short bursts of cold water. The boiler goes into test mode to perform this operation so use with caution.</li> </ul> <h3 id=formatting-options>Formatting Options<a class=headerlink href=#formatting-options title="Permanent link">~</a></h3> <ul> <li><strong>Boolean Format Dashboard</strong>. This is how boolean values are displayed in the WebUI and MQTT payloads.</li> <li><strong>Boolean Format API/MQTT</strong>. This is how boolean values are written in the MQTT payloads and API JSON output.</li> <li><strong>Enum Format API/MQTT</strong>. This is how list values are presented in the MQTT payloads and API JSON, either by it's value or the index position within the list.</li> </ul> <h3 id=temperature-sensors>Temperature Sensors<a class=headerlink href=#temperature-sensors title="Permanent link">~</a></h3> <ul> <li><strong>Enable parasite power</strong>. Select this option when using (Dallas) temperature sensors with parasitic power.</li> </ul> <h3 id=logging>Logging<a class=headerlink href=#logging title="Permanent link">~</a></h3> <ul> <li><strong>Log EMS telegrams in hexadecimal</strong> will write the telegrams in raw format as hexadecimal values everywhere.</li> <li> <p><strong>Enable Syslog</strong>: <!-- prettier-ignore --></p> <ul> <li><strong>IP</strong> is the IP address of a syslog server for capturing remote logs. Leave blank is not using SysLog.</li> <li><strong>Port</strong> if using an alternate port number. The default is 514.</li> <li><strong>Log Level</strong> sets the maximum log level for reported messages. The highest level is DEBUG which will send a lot of log data so use with caution.</li> <li><strong>Mark Interval</strong> will send out a special <code>mark</code> message to the SysLog. This is useful for timing events.</li> </ul> </li> </ul> <h2 id=mqtt-settings>MQTT Settings<a class=headerlink href=#mqtt-settings title="Permanent link">~</a></h2> <p>These settings can be found in the <code>MQTT</code> tab on the WebUI. Most are self-explanatory and the settings that are specific to EMS-ESP are:</p> <ul> <li><strong>Broker Address</strong>. Use the IP address.</li> <li><strong>Client ID</strong>. This is used internally to identify EMS-ESP with the broker and is optional. Note MQTT topics will be postfixed with the hostname (default <code>ems-esp</code>) and not the client ID.</li> <li><strong>Base</strong>. All topics are prefixed with <code>Base</code>, which is defaulted to <code>ems-esp</code> and can be changed to an individual path.</li> <li><strong>Set Clean Session</strong>. Creates a non-persistent session when enabled. Default is disabled.</li> <li><strong>QoS</strong>. Quality of Service, 0, 1 or 2. 0 is the default and suitable for more scenarios. 1 will give a guarantee that the message has been sent, but will create slightly more traffic and overhead.</li> <li><strong>Always use Retain Flag</strong>. Enable if you want to persist all the messages on the broker. Default is off.</li> <li><strong>Formatting</strong>. The <code>As individual topics</code> option will send all data as separate topics, and <code>Nested</code> will group the data into one single JSON payload. The default is nested.</li> <li><strong>Publish command output to a 'response' topic'</strong>. This takes the output from an API command (e.g. read) and publishes the result in a topic called <code>response</code>.</li> <li><strong>Publish single value topics on change</strong>. This option will immediately publish the topic and payload for each operation and only available when MQTT Discovery is disabled.</li> <li> <p><strong>Enable MQTT Discovery</strong>. Enables the integration with Home Assistant and Domoticz. <!-- - prettier-ignore --></p> <ul> <li><strong>Entity ID format</strong>: There are 3 options. The first <code>single instance, long names</code> uses the older &lt; v3.5 format. The default and recommended setting for all new installs is the 2nd option called <code>Single instance, short name</code> which uses the EMS-ESP device entity name, which is fixed and can be seen in the <code>Settings-&gt;Customization</code> page. The last option is targeted for multiple instances of EMS-ESP running and prefixes all MQTT topics with the base name (which must be unique to work).</li> <li><strong>Publish Intervals</strong>. This section is per device and sets how frequent an MQTT message is sent. When set to 0 EMS-ESP will send data automatically when there is a noticeable change, which could be within a few seconds.</li> </ul> </li> </ul> <h2 id=adding-external-sensors>Adding external sensors<a class=headerlink href=#adding-external-sensors title="Permanent link">~</a></h2> <p>External sensors, like temperature and analog sensors can be attached to a range of GPIO pins on the ESP32 chip. If using a BBQKees Gateway board it already has an external plug for Dallas temperature sensors which will be visible in the WebUI without any configuration.</p> <p>To add custom sensors click on the <code>+</code> next to <code>Sensors</code> from the Dashboard and choose between a normal Digital in/out, a Counter (counting on/off pulses), ADC for measuring voltages, Timer, Rate and PWM 0-2.</p> <p><img alt=Web src=../_media/screenshot/web_sensor.png></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Be careful when picking a GPIO so it doesn't clash with the other used GPIOs (you can select CUSTOM board profile to view your current configuration).</p> <p>EMS-ESP is connected to the low voltage bus of your heating and over-voltage can damage ems-esp and your heating. Do not power external equipment from the EMS-ESP board.</p> <p>ESP32 development boards vary in their available pin configuration. Typically you can't use 1, 6-11, 12, 14, 15, 20, 24, 28-31 and 40+. See these links <a href=https://diyprojects.io/esp32-how-to-use-gpio-digital-io-arduino-code/#.YFpVEq9KhjG>here</a> and <a href=https://nodemcu.readthedocs.io/en/dev-esp32/modules/gpio/ >here</a>.</p> </div> <p>The following GPIOs are recommended:</p> <ul> <li>digital output: 13, 19, 21, 22, 27, 33, 37, 38</li> <li>digital input/counter/timer/rate: 13, 19, 21, 22, 25, 26, 27, 33, 35, 37, 38, 39 (note no pullup on 35 &amp; 39)</li> <li>ADC input: 13, 19, 21, 22, 25, 26, 27, 33, 35, 37, 38, 39</li> <li>DAC output: 25, 26</li> <li>PWM output: 13, 19, 21, 22, 25, 26, 27, 33, 37, 38</li> </ul> <p>Limits:</p> <ul> <li>ADC: 1.5V</li> <li>DAC 8bit</li> <li>PWM: max. frequency 5000Hz, resolution 13bits</li> <li>Counter/timer/rate trigger on high-&gt;low edge with 15 ms debounce. Only for low pulse rates.</li> </ul> <h2 id=customization>Customization<a class=headerlink href=#customization title="Permanent link">~</a></h2> <p>This page shows all registered entities and allows to exclude commands and values from publishing via mqtt/api or remove them from dashboard. The dashboard only shows entities with values, the customization page shows all. If an entity has no value then it is supported by EMS-ESP, but not by your boiler/thermostat/etc.</p> <p><img alt=Web src=../_media/screenshot/web_customizations.png></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 13, 2023</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/3J3GgnzpyT target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://github.com/emsesp/EMS-ESP32 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.ba449ae6.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> <script src=../extra_javascript/github.js></script> </body> </html>